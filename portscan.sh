#!/bin/bash

if [ "$(id -u)" != "0" ]; then
    echo >&2 "This script must be run as root."
    exit 1
fi

# Help
if [ "$1" == "-h" ] || [ "$1" == "--help" ] ; then
  echo "Usage: ./scanner.sh"
  exit
fi

# Version
if [ "$1" == "-v" ] || [ "$1" == "--version" ] ; then
  echo "Port Scanner 9000 v1.0"
  exit
fi

clear

# Take in Address and Ports
echo "Enter your domain: "
#read domain
domain="www.rit.edu"

echo "Enter a starting point between 0 and 1000: "
#read start_port
start_port=79

# Validate Ports
if [ $start_port -lt 0 ] || [ $start_port -gt 1000 ]; then
echo "Invalid starting point. Please enter a number between 0 and 1000."
fi 


echo "Enter an ending port between $start_port and 1000: "
#read end_port
end_port=81

if [ $end_port -lt $start_port ] || [ $end_port -gt 1000 ]; then
echo "Invalid ending port. Please enter a number between start and 1000."
fi 

# Scan ports
scan_text=$(nmap -sS -p $start_port-$end_port $domain -oX /tmp/scantext.xml)
hostname=$(xmllint --xpath "//hostname[@type='user']/@name" /tmp/scantext.xml|cut -d '"' -f2)
sleep 5
xmlint --xpath "//port" /tmp/scantext.xml | while read -r line; do
port=$(echo "$line" | xmllint --xpath "string(//@portid)" -)
done
# nmap -sS -p 1-65535 localhost
# if error, inform user

# Handle scan_text



state="ma balls"
echo $state

reset="\033[0m"
green="\033[92m"
red="\033[91m"
yellow="\033[93m"
echo "$domain Port: $port:$state"

exit
